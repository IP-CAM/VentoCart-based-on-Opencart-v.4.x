
  <div id="option">
                  {% set option_row = 0 %}
                  {% set option_value_row = 0 %}
                  {% for product_option in product_options %}

                    <fieldset id="option-row-{{ option_row }}">
                 
                      <legend class="float-none">{{ product_option.name }} <button type="button" class="btn btn-danger btn-sm float-end" onclick="removeAllGroup({{option_row}}, {{ product_option.poption_id }});""><i class="fa-solid fa-minus-circle"></i></button></legend>
                      <input type="hidden" name="product_option[{{ option_row }}][product_option_id]" value="{{ product_option.product_option_id }}"/> <input type="hidden" name="product_option[{{ option_row }}][name]" value="{{ product_option.name }}"/> <input type="hidden" name="product_option[{{ option_row }}][option_id]" value="{{ product_option.option_id }}"/> <input type="hidden" name="product_option[{{ option_row }}][type]" value="{{ product_option.type }}"/>

                      <div class="row mb-3">
                        <label for="input-required-{{ option_row }}" class="col-sm-2 col-form-label">{{ entry_required }}</label>
                        <div class="col-sm-10">
                          <select name="product_option[{{ option_row }}][required]" id="input-required-{{ option_row }}" class="form-select">
                            <option value="1"{% if product_option.required %} selected{% endif %}>{{ text_enabled }}</option>
                            <option value="0"{% if not product_option.required %} selected{% endif %}>{{ text_disabled }}</option>
                          </select>
                        </div>
                      </div>

                      {% if product_option.type == 'text' %}
                        <div class="row mb-3">
                          <label for="input-option-{{ option_row }}" class="col-sm-2 col-form-label">{{ entry_option_value }}</label>
                          <div class="col-sm-10">
                            <input type="text" name="product_option[{{ option_row }}][value]" value="{{ product_option.value }}" placeholder="{{ entry_option_value }}" id="input-option-{{ option_row }}" class="form-control"/>
                          </div>
                        </div>
                      {% endif %}

                      {% if product_option.type == 'textarea' %}
                        <div class="row mb-3">
                          <label for="input-option-{{ option_row }}" class="col-sm-2 col-form-label">{{ entry_option_value }}</label>
                          <div class="col-sm-10">
                            <textarea name="product_option[{{ option_row }}][value]" rows="5" placeholder="{{ entry_option_value }}" id="input-option-{{ option_row }}" class="form-control">{{ product_option.value }}</textarea>
                          </div>
                        </div>
                      {% endif %}

                      {% if product_option.type == 'file' %}
                        <div class="row mb-3 d-none">
                          <label for="input-option-{{ option_row }}" class="col-sm-2 col-form-label">{{ entry_option_value }}</label>
                          <div class="col-sm-10"><input type="text" name="product_option[{{ option_row }}][value]" value="{{ product_option.value }}" placeholder="{{ entry_option_value }}" id="input-option-{{ option_row }}" class="form-control"/></div>
                        </div>
                      {% endif %}

                      {% if product_option.type == 'date' %}
                        <div class="row mb-3">
                          <label for="input-option-{{ option_row }}" class="col-sm-2 col-form-label">{{ entry_option_value }}</label>
                          <div class="col-sm-10 col-md-4">
                            <div class="input-group">
                              <input type="text" name="product_option[{{ option_row }}][value]" value="{{ product_option.value }}" placeholder="{{ entry_option_value }}" id="input-option-{{ option_row }}" class="form-control date"/>
                              <div class="input-group-text"><i class="fa-regular fa-calendar"></i></div>
                            </div>
                          </div>
                        </div>
                      {% endif %}

                      {% if product_option.type == 'time' %}
                        <div class="row mb-3">
                          <label for="input-option-{{ option_row }}" class="col-sm-2 col-form-label">{{ entry_option_value }}</label>
                          <div class="col-sm-10 col-md-4">
                            <div class="input-group">
                              <input type="text" name="product_option[{{ option_row }}][value]" value="{{ product_option.value }}" placeholder="{{ entry_option_value }}" id="input-option-{{ option_row }}" class="form-control time"/>
                              <div class="input-group-text"><i class="fa-regular fa-calendar"></i></div>
                            </div>
                          </div>
                        </div>
                      {% endif %}

                      {% if product_option.type == 'datetime' %}
                        <div class="row mb-3">
                          <label for="input-option-{{ option_row }}" class="col-sm-2 col-form-label">{{ entry_option_value }}</label>
                          <div class="col-sm-10 col-md-4">
                            <div class="input-group">
                              <input type="text" name="product_option[{{ option_row }}][value]" value="{{ product_option.value }}" placeholder="{{ entry_option_value }}" id="input-option-{{ option_row }}" class="form-control datetime"/>
                              <div class="input-group-text"><i class="fa-regular fa-calendar"></i></div>
                            </div>
                          </div>
                        </div>
                      {% endif %}
                      <input type="hidden" name="product_option[{{ option_row }}][poption_id]" value="{{ product_option.poption_id }}"/>
          
                      
                      {% if product_option.type == 'select' or product_option.type == 'radio' or product_option.type == 'checkbox' or product_option.type == 'image' %}
                        <div class="table-responsive">
                          <table class="table table-bordered table-hover">
                            <thead>
                              <tr>
                                <td class="text-start">{{ entry_option_value }}</td>
                                <td class="text-end">{{ entry_quantity }}</td>
                                <td class="text-start">{{ entry_subtract }}</td>
                                <td class="text-end">{{ entry_price }}</td>
                                <td class="text-end">{{ entry_points }}</td>
                                <td class="text-end">{{ entry_weight }}</td>
                                <td></td>
                              </tr>
                            </thead>
                            <tbody id="option-value-{{ option_row }}">

                              {% for product_option_value in product_option.product_option_value %}
                                <tr id="option-value-row-{{ option_value_row }}">
                                  <td class="text-start">{{ product_option_value.name }}

                                    <input type="hidden" name="product_option[{{ option_row }}][product_option_value][{{ option_value_row }}][poption_id]" value="{{ product_option_value.poption_id }}"/>


                                    <input type="hidden" name="product_option[{{ option_row }}][product_option_value][{{ option_value_row }}][option_value_id]" value="{{ product_option_value.option_value_id }}"/> <input type="hidden" name="product_option[{{ option_row }}][product_option_value][{{ option_value_row }}][product_option_value_id]" value="{{ product_option_value.product_option_value_id }}"/></td>
                                  <td class="text-end">{{ product_option_value.quantity }} <input type="hidden" name="product_option[{{ option_row }}][product_option_value][{{ option_value_row }}][quantity]" value="{{ product_option_value.quantity }}"/></td>
                                  <td class="text-start">{% if product_option_value.subtract %}
                                      {{ text_yes }}
                                    {% else %}
                                      {{ text_no }}
                                    {% endif %}
                                    <input type="hidden" name="product_option[{{ option_row }}][product_option_value][{{ option_value_row }}][subtract]" value="{{ product_option_value.subtract }}"/></td>
                                  <td class="text-end">{{ product_option_value.price_prefix }}{{ product_option_value.price }}
                                    <input type="hidden" name="product_option[{{ option_row }}][product_option_value][{{ option_value_row }}][price_prefix]" value="{{ product_option_value.price_prefix }}"/> <input type="hidden" name="product_option[{{ option_row }}][product_option_value][{{ option_value_row }}][price]" value="{{ product_option_value.price }}"/></td>
                                  <td class="text-end">{{ product_option_value.points_prefix }}{{ product_option_value.points }}
                                    <input type="hidden" name="product_option[{{ option_row }}][product_option_value][{{ option_value_row }}][points_prefix]" value="{{ product_option_value.points_prefix }}"/> <input type="hidden" name="product_option[{{ option_row }}][product_option_value][{{ option_value_row }}][points]" value="{{ product_option_value.points }}"/></td>
                                  <td class="text-end">{{ product_option_value.weight_prefix }}{{ product_option_value.weight }}
                                    <input type="hidden" name="product_option[{{ option_row }}][product_option_value][{{ option_value_row }}][weight_prefix]" value="{{ product_option_value.weight_prefix }}"/> <input type="hidden" name="product_option[{{ option_row }}][product_option_value][{{ option_value_row }}][weight]" value="{{ product_option_value.weight }}"/></td>
                                  <td class="text-end">
                                    
<button type="button" data-bs-toggle="tooltip" title="{{ button_edit }}" data-option-row="{{ option_row }}" data-option-value-row="{{ option_value_row }}" data-poption-id="{{product_option_value.poption_id }}" class="btn btn-primary"> <i class="fa-solid fa-pencil"></i></button> 
                                    
                                   
                                    
                                

                                    <button type="button" onclick="removeOptionValue({{ option_value_row }}, {{ option_value_row }}, {{product_option_value.poption_id }});" data-bs-toggle="tooltip" title="{{ button_remove }}" class="btn btn-danger">
                                      <i class="fa-solid fa-minus-circle"></i>
                                  </button>

                                  
                                </tr>
                                {% set option_value_row = option_value_row + 1 %}
                              {% endfor %}
                            </tbody>
                            <tfoot>
                              <tr>
                                <td colspan="6"></td>
                                <td class="text-end"> 
                                    <button type="button" data-bs-toggle="tooltip" title="{{ button_option_value_add }}"  data-option-row="{{ option_row }}" class="btn btn-primary"><i class="fa-solid fa-plus-circle"></i></button></td>
                              </tr>
                            </tfoot>
                          </table>
                          <select id="product-option-values-{{ option_row }}" class="d-none">
                            {% if option_values[product_option.option_id] %}
                              {% for option_value in option_values[product_option.option_id] %}
                                <option value="{{ option_value.option_value_id }}">{{ option_value.name }}</option>
                              {% endfor %}
                            {% endif %}
                          </select>
                        </div>
                      {% endif %}
                    </fieldset>

                    {% set option_row = option_row + 1 %}
                  {% endfor %}
                </div>

           
              </div>

              <fieldset>
                <legend class="float-none">{{ text_option_add }}</legend>
                <div class="row mb-3">
                  <label for="input-option" class="col-sm-2 col-form-label">{{ entry_option }}</label>
                  <div class="col-sm-10">
                    <input type="text" name="option" value="" placeholder="{{ entry_option }}" id="input-option" data-oc-target="autocomplete-option" class="form-control" autocomplete="off"/>
                    <ul id="autocomplete-option" class="dropdown-menu"></ul>
                    <div class="form-text">{{ help_option }}</div>
                  </div>
                </div>
              </fieldset>
<!--  hidden modal edit option -->
<div id="modal-option" class="modal fade" style="display: none;">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title"><i class="fa-solid fa-pencil"></i> {{ text_option_value  }}</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <div class="mb-3">
                    <label for="input-modal-option-value" class="form-label">{{ entry_option_value  }}</label>
                    <select name="option_value_id" id="input-modal-option-value" class="form-select"></select>
                    <input type="hidden" name="product_option_value_id" value="" />
                </div>

                <div class="mb-3">
                    <label for="input-modal-quantity" class="form-label">{{ entry_quantity  }}</label>
                    <input type="text" name="optquantity" value="" placeholder="{{ entry_quantity  }}" id="input-modal-quantity" class="form-control" />
                </div>

                <div class="mb-3">
                    <label for="input-modal-subtract" class="form-label">{{ entry_subtract }}</label>
                    <select name="optsubtract" id="input-modal-subtract" class="form-select">
                        <option value="1">{{ text_yes  }}</option>
                        <option value="0">{{ text_no }}</option>
                    </select>
                </div>

                <div class="mb-3">
                    <label for="input-modal-price" class="form-label">{{ entry_price }}</label>
                    <div class="input-group">
                        <select name="optprice_prefix" class="form-select">
                          
                            <option value="+">+</option>
                            <option value="-">-</option>
                            <option value="=">=</option>
                        </select>
                        <input type="text" name="optprice" value="{{ (element.attr('data-option-value-row') ? 'Your Dynamic Value' : '0') }}" placeholder="{{ entry_price  }}" id="input-modal-price" class="form-control" />
                    </div>
                </div>
                
                <div class="mb-3">
                    <label for="input-modal-points" class="form-label">{{ entry_points  }}</label>
                    <div class="input-group">
                        <select name="optpoints_prefix" class="form-select">
                      
                            <option value="+">+</option>
                            <option value="-">-</option>
                        </select>
                        <input type="text" name="optpoints" value="{{ (element.attr('data-option-value-row') ? 'Your Dynamic Value' : '0') }}" placeholder="{{ entry_points  }}" id="input-modal-points" class="form-control" />
                    </div>
                </div>
                
                <div class="mb-3">
                    <label for="input-modal-weight" class="form-label">{{ entry_weight }}</label>
                    <div class="input-group">
                        <select name="optweight_prefix" class="form-select">
                  
                            <option value="+">+</option>
                            <option value="-">-</option>
                        </select>
                        <input type="text" name="optweight" value="{{ (element.attr('data-option-value-row') ? 'Your Dynamic Value' : '0') }}" placeholder="{{ entry_weight  }}" id="input-modal-weight" class="form-control" />
                    </div>
                </div>
                
            </div>
            <div class="modal-footer">
                <button type="button" id="button-save" class="btn btn-primary">{{ button_save }}</button>
                <button type="button" class="btn btn-light" data-bs-dismiss="modal">{{ button_cancel  }}</button>
            </div>
        </div>
    </div>
</div>

              <script>

                $('#input-option').autocomplete({
    'source': function (request, response) {
        $.ajax({
            url: 'index.php?route=catalog/option.autocomplete&user_token={{ user_token }}&filter_name=' + encodeURIComponent(request),
            dataType: 'json',
            success: function (json) {
                response($.map(json, function (item) {
                    return {
                        category: item['category'],
                        label: item['name'],
                        value: item['option_id'],
                        type: item['type'],
                        option_value: item['option_value']
                    }
                }));
            }
        });
    },
    'select': function (item) {  
        html = '<fieldset id="option-row-' + option_row + '">';
        html += '    <legend class="float-none">' + item['label'] + ' <button type="button" class="btn btn-danger btn-sm float-end" onclick="$(\'#option-row-' + option_row + '\').remove();"><i class="fa-solid fa-minus-circle"></i></button></legend>';
        html += '  <input type="hidden" name="product_option[' + option_row + '][product_option_id]" value="" />';
        html += '  <input type="hidden" name="product_option[' + option_row + '][name]" value="' + item['label'] + '" />';
        html += '  <input type="hidden" name="product_option[' + option_row + '][option_id]" value="' + item['value'] + '" />';
        html += '  <input type="hidden" name="product_option[' + option_row + '][type]" value="' + item['type'] + '" />';
      
        html += '  <div class="row mb-3">';
        html += '    <label for="input-required-' + option_row + '" class="col-sm-2 col-form-label">{{ entry_required|escape('js') }}</label>';
        html += '	   <div class="col-sm-10"><select name="product_option[' + option_row + '][required]" id="input-required-' + option_row + '" class="form-select">';
        html += '	     <option value="1">{{ text_yes|escape('js') }}</option>';
        html += '	     <option value="0">{{ text_no|escape('js') }}</option>';
        html += '	 </select></div>';
        html += '  </div>';

        if (item['type'] == 'text') {
            html += '	<div class="row mb-3">';
            html += '	  <label for="input-option-' + option_row + '" class="col-sm-2 col-form-label">{{ entry_option_value|escape('js') }}</label>';
            html += '	  <div class="col-sm-10"><input type="text" name="product_option[' + option_row + '][value]" value="" placeholder="{{ entry_option_value|escape('js') }}" id="input-option-' + option_row + '" class="form-control"/></div>';
            html += '	</div>';
        }

        if (item['type'] == 'textarea') {
            html += '	<div class="row mb-3">';
            html += '	  <label for="input-option-' + option_row + '" class="col-sm-2 col-form-label">{{ entry_option_value|escape('js') }}</label>';
            html += '	  <div class="col-sm-10"><textarea name="product_option[' + option_row + '][value]" rows="5" placeholder="{{ entry_option_value|escape('js') }}" id="input-option-' + option_row + '" class="form-control"></textarea></div>';
            html += '	</div>';
        }

        if (item['type'] == 'file') {
            html += '	<div class="row mb-3 d-none">';
            html += '	  <label for="input-option-' + option_row + '" class="col-sm-2 col-form-label">{{ entry_option_value|escape('js') }}</label>';
            html += '	  <div class="col-sm-10 d-none"><input type="text" name="product_option[' + option_row + '][value]" value="" placeholder="{{ entry_option_value|escape('js') }}" id="input-option-' + option_row + '" class="form-control"/></div>';
            html += '	</div>';
        }

        if (item['type'] == 'date') {
            html += '	<div class="row mb-3">';
            html += '	  <label for="input-option-' + option_row + '" class="col-sm-2 col-form-label">{{ entry_option_value|escape('js') }}</label>';
            html += '	  <div class="col-sm-10 col-md-4"><div class="input-group"><input type="text" name="product_option[' + option_row + '][value]" value="" placeholder="{{ entry_option_value|escape('js') }}" id="input-option-' + option_row + '" class="form-control date"/><div class="input-group-text"><i class="fa-regular fa-calendar"></i></div></div></div>';
            html += '	</div>';
        }

        if (item['type'] == 'time') {
            html += '	<div class="row mb-3">';
            html += '	  <label for="input-option-' + option_row + '" class="col-sm-2 col-form-label">{{ entry_option_value|escape('js') }}</label>';
            html += '	  <div class="col-sm-10 col-md-4"><div class="input-group"><input type="text" name="product_option[' + option_row + '][value]" value="" placeholder="{{ entry_option_value|escape('js') }}" id="input-option-' + option_row + '" class="form-control time"/><div class="input-group-text"><i class="fa-regular fa-calendar"></i></div></div></div>';
            html += '	</div>';
        }

        if (item['type'] == 'datetime') {
            html += '	<div class="row mb-3">';
            html += '	  <label for="input-option-' + option_row + '" class="col-sm-2 col-form-label">{{ entry_option_value|escape('js') }}</label>';
            html += '	  <div class="col-sm-10 col-md-4"><div class="input-group"><input type="text" name="product_option[' + option_row + '][value]" value="" placeholder="{{ entry_option_value|escape('js') }}" id="input-option-' + option_row + '" class="form-control datetime"/><div class="input-group-text"><i class="fa-regular fa-calendar"></i></div></div></div>';
            html += '	</div>';
        }

        if (item['type'] == 'select' || item['type'] == 'radio' || item['type'] == 'checkbox' || item['type'] == 'image') {
            html += '<div class="table-responsive">';
            html += '  <table id="option-value-' + option_row + '" class="table table-bordered table-hover">';
            html += '  	 <thead>';
            html += '      <tr>';
            html += '        <td class="text-start">{{ entry_option_value|escape('js') }}</td>';
            html += '        <td class="text-end">{{ entry_quantity|escape('js') }}</td>';
            html += '        <td class="text-start">{{ entry_subtract|escape('js') }}</td>';
            html += '        <td class="text-end">{{ entry_price|escape('js') }}</td>';
            html += '        <td class="text-end">{{ entry_points|escape('js') }}</td>';
            html += '        <td class="text-end">{{ entry_weight|escape('js') }}</td>';
            html += '        <td></td>';
            html += '      </tr>';
            html += '    </thead>';
            html += '    <tbody></tbody>';
            html += '    <tfoot>';
            html += '      <tr>';
            html += '        <td colspan="6"></td>';
            html += '        <td class="text-end"><button type="button" data-option-row="' + option_row + '" data-bs-toggle="tooltip" title="{{ button_option_value_add|escape('js') }}" class="btn btn-primary"><i class="fa-solid fa-plus-circle"></i></button></td>';
            html += '      </tr>';
            html += '    </tfoot>';
            html += '  </table>';
            html += '</div>';

            html += '  <select id="product-option-values-' + option_row + '" class="d-none">';

            for (i = 0; i < item['option_value'].length; i++) {
                html += '<option value="' + item['option_value'][i]['option_value_id'] + '">' + item['option_value'][i]['name'] + '</option>';
            }

            html += '  </select>';
            html += '</fieldset>';
        }

        $('#option').append(html);

        option_row++;
    }
});

var option_row = {{ option_row }};

 

var option_value_row = {{ option_value_row }};

 
$('#option').on('click', '.btn-primary', function () {
    var element = this;
    var optionValueRow;

    if ($(element).attr('data-option-value-row')) {
        optionValueRow = $(element).attr('data-option-value-row');
    } else {
        optionValueRow = option_value_row;
    }

    var optionRow = $(element).attr('data-option-row'); // Make sure to get the correct optionRow

    var optionValueSelect = $('#input-modal-option-value');
    var option_value = $('#product-option-values-' + optionRow + ' option'); // Use optionRow instead of $(element).attr('data-option-row')

    // Clear existing options before appending new ones
    optionValueSelect.empty();

    for (var i = 0; i < option_value.length; i++) {
        var optionValueId = $(option_value[i]).val();
        var optionValueText = $(option_value[i]).text();

        var option = $('<option></option>')
            .attr('value', optionValueId)
            .text(optionValueText);

        if (
            optionValueRow &&
            optionValueId == $('input[name=\'product_option[' + optionRow + '][product_option_value][' + optionValueRow + '][option_value_id]\']').val()
        ) {
            option.attr('selected', 'selected');
        }

        optionValueSelect.append(option);
    }

    // Get existing values if available
    var quantityValue = optionValueRow ? $('input[name=\'product_option[' + optionRow + '][product_option_value][' + optionValueRow + '][quantity]\']').val() : '1';
    var subtractValue = optionValueRow ? $('input[name=\'product_option[' + optionRow + '][product_option_value][' + optionValueRow + '][subtract]\']').val() : '0';
    var pricePrefixValue = optionValueRow ? $('input[name=\'product_option[' + optionRow + '][product_option_value][' + optionValueRow + '][price_prefix]\']').val() : '+';
    var priceValue = optionValueRow ? $('input[name=\'product_option[' + optionRow + '][product_option_value][' + optionValueRow + '][price]\']').val() : '0';
    var pointsPrefixValue = optionValueRow ? $('input[name=\'product_option[' + optionRow + '][product_option_value][' + optionValueRow + '][points_prefix]\']').val() : '+';
    var pointsValue = optionValueRow ? $('input[name=\'product_option[' + optionRow + '][product_option_value][' + optionValueRow + '][points]\']').val() : '0';
    var weightPrefixValue = optionValueRow ? $('input[name=\'product_option[' + optionRow + '][product_option_value][' + optionValueRow + '][weight_prefix]\']').val() : '+';
    var weightValue = optionValueRow ? $('input[name=\'product_option[' + optionRow + '][product_option_value][' + optionValueRow + '][weight]\']').val() : '0';

    // Set values in the modal
    $('#input-modal-quantity').val(quantityValue);
    $('#input-modal-subtract').val(subtractValue);
    $('#input-modal-price-prefix').val(pricePrefixValue);
    $('#input-modal-price').val(priceValue);
    $('#input-modal-points-prefix').val(pointsPrefixValue);
    $('#input-modal-points').val(pointsValue);
    $('#input-modal-weight-prefix').val(weightPrefixValue);
    $('#input-modal-weight').val(weightValue);

    // Show the modal
    $('#modal-option').modal('show');

    // Add event listener for save button
    $('#modal-option #button-save').off('click').on('click', function () {
    html = '<tr id="option-value-row-' + optionValueRow+ '">';
  
    html = '<tr id="option-value-row-' + optionValueRow+ '">';
        html += '  <td class="text-start">' + $('#modal-option select[name=\'option_value_id\'] option:selected').text() + '<input type="hidden" name="product_option[' + $(element).attr('data-option-row') + '][product_option_value][' + optionValueRow  + '][option_value_id]" value="' + $('#modal-option select[name=\'option_value_id\']').val() + '"/><input type="hidden" name="product_option[' + $(element).attr('data-option-row') + '][product_option_value][' + optionValueRow + '][poption_id]" value="' +  $(element).attr('data-poption-id')  + '"/></td>';
        html += '  <td class="text-end">' + $('#modal-option input[name=\'optquantity\']').val() + '<input type="hidden" name="product_option[' + $(element).attr('data-option-row') + '][product_option_value][' + optionValueRow + '][quantity]" value="' + $('#modal-option input[name=\'optquantity\']').val() + '"/></td>';
        html += '  <td class="text-start">' + ($('#modal-option select[name=\'optsubtract\'] option:selected').val() == '1' ? '{{ text_yes|escape('js') }}' : '{{ text_no|escape('js') }}') + '<input type="hidden" name="product_option[' + $(element).attr('data-option-row') + '][product_option_value][' + optionValueRow + '][subtract]" value="' + $('#modal-option select[name=\'optsubtract\'] option:selected').val() + '"/></td>';
        html += '  <td class="text-end">' + $('#modal-option select[name=\'optprice_prefix\'] option:selected').val() + $('#modal-option input[name=\'optprice\']').val() + '<input type="hidden" name="product_option[' + $(element).attr('data-option-row') + '][product_option_value][' + optionValueRow  + '][price_prefix]" value="' + $('#modal-option select[name=\'optprice_prefix\'] option:selected').val() + '"/><input type="hidden" name="product_option[' + $(element).attr('data-option-row') + '][product_option_value][' + optionValueRow + '][price]" value="' + $('#modal-option input[name=\'optprice\']').val() + '"/></td>';
        html += '  <td class="text-end"> ' + $('#modal-option select[name=\'optpoints_prefix\'] option:selected').val() + $('#modal-option input[name=\'optpoints\']').val() + '<input type="hidden" name="product_option[' + $(element).attr('data-option-row') + '][product_option_value][' + optionValueRow + '][points_prefix]" value="' + $('#modal-option select[name=\'optpoints_prefix\'] option:selected').val() + '"/><input type="hidden" name="product_option[' + $(element).attr('data-option-row') + '][product_option_value][' + optionValueRow + '][points]" value="' + $('#modal-option input[name=\'optpoints\']').val() + '"/></td>';
        html += '  <td class="text-end">' + $('#modal-option select[name=\'optweight_prefix\'] option:selected').val() + $('#modal-option input[name=\'optweight\']').val() + '<input type="hidden" name="product_option[' + $(element).attr('data-option-row') + '][product_option_value][' + optionValueRow + '][weight_prefix]" value="' + $('#modal-option select[name=\'optweight_prefix\'] option:selected').val() + '"/><input type="hidden" name="product_option[' + $(element).attr('data-option-row') + '][product_option_value][' + optionValueRow + '][weight]" value="' + $('#modal-option input[name=\'optweight\']').val() + '"/></td>';
        html += '  <td class="text-end"><button type="button" data-poption-id="' +   $(element).attr('data-poption-id')  + '" data-bs-toggle="tooltip" title="{{ button_edit|escape('js') }}" data-option-row="' + $(element).attr('data-option-row') + '" data-option-value-row="' + optionValueRow + '"class="btn btn-primary"><i class="fa-solid fa-pencil"></i></button> <button type="button" onclick="$(\'#option-value-row-' + optionValueRow+ '\').remove();" data-bs-toggle="tooltip" rel="tooltip" title="{{ button_remove|escape('js') }}" class="btn btn-danger"><i class="fa-solid fa-minus-circle"></i></button></td>';
    // Get the element
    let originalElement = $("#option-value-row-" + optionValueRow + "-pop");
     
    // Get attributes of the original element
    let name = originalElement.attr("name");
    let id = originalElement.attr("id");
    let value = originalElement.val();
    var productOptionData = {
        optionValueText: $('#modal-option select[name=\'option_value_id\'] option:selected').text(),
        optionValueId: $('#modal-option select[name=\'option_value_id\']').val(),
        productOptionValueId: $('#modal-option input[name=\'product_option_value_id\']').val(),
        quantity: $('#modal-option input[name=\'quantity\']').val(),
        subtract: $('#modal-option select[name=\'subtract\'] option:selected').val() == '1' ? '{{ text_yes|escape('js') }}' : '{{ text_no|escape('js') }}',
        pricePrefix: $('#modal-option select[name=\'price_prefix\'] option:selected').val(),
        price: $('#modal-option input[name=\'price\']').val(),
        pointsPrefix: $('#modal-option select[name=\'points_prefix\'] option:selected').val(),
        points: $('#modal-option input[name=\'points\']').val(),
        weightPrefix: $('#modal-option select[name=\'weight_prefix\'] option:selected').val(),
        weight: $('#modal-option input[name=\'weight\']').val()
    }

    if ($(element).attr('data-option-value-row')) {
        
      
        $('#option-value-row-' + optionValueRow).replaceWith(html);
    } else {
        $('#option-value-' + $(element).attr('data-option-row')).append(html);
        option_value_row++;
    }

    $('#modal-option').modal('hide');
});
});

function removeOptionValue(optionValueRow, optionRow, poptionId) {
      
    $('#option-value-row-' + optionValueRow).html('<input type="hidden" name="product_option[' + optionValueRow + '][delete]" value="' + poptionId + '"/>');
   
}

function removeAllGroup(optionValueRow, poptionId) {
 
 let newHiddenInput = '';
    $('#option-row-' + optionValueRow + ' input[type="hidden"][name$="[poption_id]"]').each(function () {
        var poptionIds = $(this).val();
          newHiddenInput += '<input type="hidden" name="product_option[' + poptionIds + '][delete]" value="' + poptionIds + '"/>';
        console.log(newHiddenInput);

        
    });
 
    $('#option-row-' + optionValueRow).html('');
    $('#option-row-' + optionValueRow).append(newHiddenInput);
    $('#option-value-row-' + optionValueRow).append('<input type="hidden" name="product_option[' + poptionId + '][delete]" value="' + poptionId + '"/>');
    $('#option-row-' + optionValueRow).hide();
}
                </script>